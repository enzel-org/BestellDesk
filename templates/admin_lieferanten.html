<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Lieferanten verwalten</title>
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='admin_lieferanten.css') }}">
</head>
<body>
    <h1>Lieferanten</h1>

    <form method="post" class="lieferant-form">
        <label>Name: <input type="text" name="name" required></label><br>
        <label>Versandkosten pro Person (€): <input type="number" step="0.01" name="versand" required></label><br>
        <label>WhatsApp-Nummer: <input type="text" name="whatsapp" placeholder="z. B. +491234567890"></label><br>

        <label>Speisekarte:</label><br>
        <input type="radio" name="menu_typ" value="link" checked onchange="toggleMenuInput()"> Link<br>
        <input type="radio" name="menu_typ" value="text" onchange="toggleMenuInput()"> Beschreibung<br>

        <input type="text" name="menu_info" id="menu_info_input" placeholder="https://example.com" required><br>

        <button type="submit">Hinzufügen</button>
    </form>

    <script>
    function toggleMenuInput() {
        const type = document.querySelector('input[name="menu_typ"]:checked').value;
        const input = document.getElementById("menu_info_input");
        input.placeholder = type === "link" ? "https://example.com" : "z. B. liegt im Büro";
    }
    </script>

    <hr>

    {% if lieferanten %}
        <div class="lieferanten-liste">
            {% for l in lieferanten %}
                <div class="lieferant-box{% if l.aktiv %} aktiv{% endif %}">
                    <div class="kopfzeile">
                        <strong>{{ l.name }}</strong>
                        {% if l.aktiv %}<span class="badge">Aktiv</span>{% endif %}
                    </div>
                    <div class="details">
                        <small>{{ l.whatsapp_nummer or "(keine Nummer angegeben)" }}</small><br>
                        Versand: {{ "%.2f"|format(l.versand_pro_person) }} €<br>
                        {% if l.menu_typ == "link" %}
                            <a href="{{ l.menu_info }}" target="_blank">Speisekarte öffnen</a><br>
                        {% elif l.menu_typ == "text" %}
                            <em>{{ l.menu_info }}</em><br>
                        {% endif %}
                    </div>
                    <div class="aktion-buttons">
                        <form method="post" action="/admin/lieferant/aktivieren/{{ l._id }}">
                            <button type="submit">Aktiv setzen</button>
                        </form>
                        <form method="get" action="/admin/lieferant/bearbeiten/{{ l._id }}">
                            <button type="submit">Bearbeiten</button>
                        </form>
                        <form method="post" action="/admin/lieferant/loeschen/{{ l._id }}" onsubmit="return confirm('Wirklich löschen?');">
                            <button type="submit">Löschen</button>
                        </form>
                    </div>
                </div>
                <hr>
            {% endfor %}
        </div>
    {% else %}
        <p>Keine Lieferanten vorhanden.</p>
    {% endif %}

    <a href="/admin">Zurück zum Adminbereich</a>
</body>
</html>
