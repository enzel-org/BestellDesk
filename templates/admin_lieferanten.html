<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Lieferanten verwalten</title>
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
</head>
<body>
    <h1>Lieferanten</h1>

    <form method="post">
        <label>Name: <input type="text" name="name" required></label><br>
        <label>Versandkosten pro Person (€): <input type="number" step="0.01" name="versand" required></label><br>

        <label>Speisekarte:</label><br>
        <input type="radio" name="menu_typ" value="link" checked onchange="toggleMenuInput()"> Link<br>
        <input type="radio" name="menu_typ" value="text" onchange="toggleMenuInput()"> Beschreibung<br>

        <input type="text" name="menu_info" id="menu_info_input" placeholder="https://example.com" required><br>

        <button type="submit">Hinzufügen</button>
    </form>

    <script>
    function toggleMenuInput() {
        const type = document.querySelector('input[name="menu_typ"]:checked').value;
        const input = document.getElementById("menu_info_input");
        input.placeholder = type === "link" ? "https://example.com" : "z. B. liegt im Büro";
    }
    </script>

    <hr>

    {% if lieferanten %}
        <ul>
            {% for l in lieferanten %}
                <li>
                    <strong>{{ l.name }}</strong> ({{ "%.2f"|format(l.versand_pro_person) }} € pro Person)
                    {% if l.aktiv %} ✅ Aktiv {% endif %}<br>

                    {% if l.menu_typ == "link" %}
                        <a href="{{ l.menu_info }}" target="_blank">Speisekarte öffnen</a><br>
                    {% elif l.menu_typ == "text" %}
                        <em>{{ l.menu_info }}</em><br>
                    {% endif %}

                    <form method="post" action="/admin/lieferant/aktivieren/{{ l._id }}">
                        <button type="submit">Aktivieren</button>
                    </form>

                    <form method="get" action="/admin/lieferant/bearbeiten/{{ l._id }}">
                        <button type="submit">Bearbeiten</button>
                    </form>

                    <form method="post" action="/admin/lieferant/loeschen/{{ l._id }}" onsubmit="return confirm('Wirklich löschen?');">
                        <button type="submit">Löschen</button>
                    </form>
                </li>
                <hr>
            {% endfor %}
        </ul>
    {% else %}
        <p>Keine Lieferanten vorhanden.</p>
    {% endif %}

    <a href="/admin">Zurück zum Adminbereich</a>
</body>
</html>
